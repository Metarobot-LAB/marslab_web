<!-- People 드롭다운 메뉴 제어 스크립트 -->
<script>
// People 드롭다운 메뉴 제어 - 강화 버전
(function() {
  function findPeopleMenu() {
    // 모든 링크를 순회하며 "People" 텍스트 찾기
    const allLinks = document.querySelectorAll('a');
    let peopleLink = null;
    let peopleItem = null;
    let peopleChildren = null;
    
    for (let link of allLinks) {
      const text = link.textContent.trim();
      if (text === 'People') {
        peopleLink = link;
        peopleItem = link.closest('li') || link.parentElement;
        
        // 부모 요소에서 children 찾기
        if (peopleItem) {
          // 다양한 방법으로 children 찾기
          peopleChildren = peopleItem.querySelector('ul') ||
                          peopleItem.querySelector('.nav__children') ||
                          peopleItem.querySelector('.submenu') ||
                          peopleItem.querySelector('[class*="children"]') ||
                          peopleItem.querySelector('[class*="dropdown"]');
          
          // 형제 요소로 있을 수도 있음
          if (!peopleChildren) {
            const nextSibling = peopleItem.nextElementSibling;
            if (nextSibling && (nextSibling.tagName === 'UL' || nextSibling.classList.contains('nav__children'))) {
              peopleChildren = nextSibling;
            }
          }
        }
        break;
      }
    }
    
    return { peopleLink, peopleItem, peopleChildren };
  }
  
  function initPeopleDropdown() {
    const { peopleLink, peopleItem, peopleChildren } = findPeopleMenu();
    
    if (!peopleLink) {
      console.log('People link not found, retrying...');
      setTimeout(initPeopleDropdown, 300);
      return;
    }
    
    console.log('People menu found:', { peopleLink, peopleItem, peopleChildren });
    
    // People 링크 클릭 완전 차단 (여러 방법 시도)
    function blockClick(e) {
      e.preventDefault();
      e.stopPropagation();
      e.stopImmediatePropagation();
      return false;
    }
    
    peopleLink.addEventListener('click', blockClick, true);
    peopleLink.addEventListener('click', blockClick, false);
    peopleLink.onclick = blockClick;
    
    // href 비활성화
    peopleLink.setAttribute('href', 'javascript:void(0);');
    peopleLink.style.pointerEvents = 'none';
    peopleLink.style.cursor = 'default';
    peopleLink.style.textDecoration = 'none';
    
    // children이 있는 경우 드롭다운 제어
    if (peopleChildren) {
      // 초기 상태 설정
      peopleChildren.style.display = 'none';
      peopleChildren.style.visibility = 'hidden';
      peopleChildren.style.opacity = '0';
      peopleChildren.style.position = 'absolute';
      peopleChildren.style.zIndex = '9999';
      peopleChildren.style.background = '#fff';
      peopleChildren.style.border = '1px solid #ddd';
      peopleChildren.style.borderRadius = '4px';
      peopleChildren.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
      peopleChildren.style.padding = '8px 0';
      peopleChildren.style.marginTop = '4px';
      peopleChildren.style.minWidth = '150px';
      peopleChildren.style.top = '100%';
      peopleChildren.style.left = '0';
      peopleChildren.classList.add('people-dropdown');
      
      // peopleItem에 상대 위치 설정
      if (peopleItem) {
        peopleItem.style.position = 'relative';
      }
      
      // 호버 이벤트
      function showDropdown() {
        peopleChildren.style.display = 'block';
        peopleChildren.style.visibility = 'visible';
        peopleChildren.style.opacity = '1';
      }
      
      function hideDropdown() {
        setTimeout(function() {
          if (!peopleItem.matches(':hover') && !peopleChildren.matches(':hover')) {
            peopleChildren.style.display = 'none';
            peopleChildren.style.visibility = 'hidden';
            peopleChildren.style.opacity = '0';
          }
        }, 200);
      }
      
      if (peopleItem) {
        peopleItem.addEventListener('mouseenter', showDropdown);
        peopleItem.addEventListener('mouseleave', hideDropdown);
      }
      
      peopleChildren.addEventListener('mouseenter', showDropdown);
      peopleChildren.addEventListener('mouseleave', hideDropdown);
      
      // children 내부 링크 스타일
      const childLinks = peopleChildren.querySelectorAll('a');
      childLinks.forEach(function(link) {
        link.style.display = 'block';
        link.style.padding = '8px 16px';
        link.style.color = '#333';
        link.style.textDecoration = 'none';
        link.addEventListener('mouseenter', function() {
          this.style.backgroundColor = '#f5f5f5';
        });
        link.addEventListener('mouseleave', function() {
          this.style.backgroundColor = 'transparent';
        });
      });
    } else {
      console.log('People children menu not found');
      // children이 없으면 동적으로 생성 시도
      if (peopleItem) {
        peopleItem.style.position = 'relative';
      }
    }
  }
  
  // 여러 시점에서 실행
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initPeopleDropdown);
  } else {
    initPeopleDropdown();
  }
  
  // 지연 실행 (동적 로딩 대응)
  setTimeout(initPeopleDropdown, 500);
  setTimeout(initPeopleDropdown, 1000);
  setTimeout(initPeopleDropdown, 2000);
  
  // MutationObserver로 DOM 변경 감지
  const observer = new MutationObserver(function(mutations) {
    initPeopleDropdown();
  });
  
  observer.observe(document.body, {
    childList: true,
    subtree: true
  });
})();
</script>
