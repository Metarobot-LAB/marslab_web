<style>
  /* 드롭다운 메뉴 스타일 */
  .custom-dropdown-menu {
    position: absolute !important;
    top: 100% !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    background: #fff !important;
    min-width: 160px !important;
    box-shadow: 0 4px 15px rgba(0,0,0,0.15) !important;
    border: 1px solid #eee !important;
    border-radius: 8px !important;
    z-index: 999999 !important;
    padding: 8px 0 !important;
    list-style: none !important;
    margin-top: 10px !important;
    margin-left: 0 !important;
    opacity: 0 !important;
    visibility: hidden !important;
    pointer-events: none !important;
    transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out, transform 0.2s ease-in-out !important;
  }

  .custom-dropdown-menu.show {
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto !important;
    transform: translateX(-50%) translateY(0) !important;
  }

  .custom-dropdown-menu::before {
    content: '' !important;
    position: absolute !important;
    top: -6px !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    border-left: 6px solid transparent !important;
    border-right: 6px solid transparent !important;
    border-bottom: 6px solid #fff !important;
  }

  .custom-dropdown-menu li {
    margin: 0 !important;
    padding: 0 !important;
    display: block !important;
    text-align: center !important;
  }

  .custom-dropdown-menu a {
    display: block !important;
    padding: 10px 20px !important;
    color: #333 !important;
    text-decoration: none !important;
    font-size: 0.95em !important;
    font-weight: 500 !important;
    transition: background 0.2s !important;
  }

  .custom-dropdown-menu a:hover {
    background-color: #f5f7fa !important;
    color: #000 !important;
  }

  .has-dropdown {
    position: relative !important;
  }

  /* [필수] 상단바가 드롭다운을 가리지 않도록 설정 */
  .masthead, 
  .masthead__inner-wrap, 
  .greedy-nav, 
  .greedy-nav .visible-links,
  .greedy-nav__list,
  .greedy-nav__list li {
    overflow: visible !important;
  }
</style>

<script>
(function() {
  let dropdownSetup = false;
  
  function setupPeopleDropdown() {
    if (dropdownSetup) {
      return true;
    }
    
    // 네비게이션 영역에서 People 링크 찾기
    const navLinks = document.querySelectorAll('.greedy-nav a, .masthead a, nav a');
    let peopleLink = null;
    let peopleItem = null;
    
    for (let link of navLinks) {
      const text = link.textContent.trim();
      if (text === 'People') {
        peopleLink = link;
        // li 요소 찾기
        peopleItem = link.closest('li');
        if (!peopleItem) {
          // li가 없으면 부모 요소 사용
          peopleItem = link.parentElement;
          // div나 다른 요소면 한 단계 더 올라가기
          if (peopleItem && peopleItem.tagName !== 'LI') {
            peopleItem = peopleItem.closest('li') || peopleItem;
          }
        }
        break;
      }
    }
    
    if (!peopleLink || !peopleItem) {
      return false;
    }
    
    // 이미 설정되어 있으면 스킵
    if (peopleItem.classList.contains('has-dropdown')) {
      const existingDropdown = peopleItem.querySelector('.custom-dropdown-menu');
      if (existingDropdown) {
        dropdownSetup = true;
        return true;
      }
    }
    
    // 클래스 추가
    peopleItem.classList.add('has-dropdown');
    peopleItem.style.position = 'relative';
    
    // 링크 기능 비활성화
    const originalHref = peopleLink.href;
    peopleLink.href = 'javascript:void(0);';
    peopleLink.style.cursor = 'pointer';
    
    // 클릭 이벤트 차단
    peopleLink.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      return false;
    }, true);
    
    // 드롭다운 생성
    let dropdown = document.createElement('ul');
    dropdown.className = 'custom-dropdown-menu';
    
    // baseurl 감지
    const currentPath = window.location.pathname;
    let baseurl = '';
    if (currentPath.includes('/mars.github.io')) {
      baseurl = '/mars.github.io';
    }
    
    dropdown.innerHTML = '<li><a href="' + baseurl + '/students/">Students</a></li><li><a href="' + baseurl + '/alumni/">Alumni</a></li>';
    peopleItem.appendChild(dropdown);
    
    // 호버 이벤트 처리
    let hoverTimeout = null;
    let isHovering = false;
    
    function showDropdown() {
      if (hoverTimeout) {
        clearTimeout(hoverTimeout);
        hoverTimeout = null;
      }
      isHovering = true;
      dropdown.classList.add('show');
    }
    
    function hideDropdown() {
      isHovering = false;
      hoverTimeout = setTimeout(function() {
        if (!isHovering) {
          dropdown.classList.remove('show');
        }
      }, 150);
    }
    
    // 이벤트 리스너 추가
    peopleItem.addEventListener('mouseenter', showDropdown, true);
    peopleItem.addEventListener('mouseleave', hideDropdown, true);
    peopleLink.addEventListener('mouseenter', showDropdown, true);
    
    dropdown.addEventListener('mouseenter', function() {
      if (hoverTimeout) {
        clearTimeout(hoverTimeout);
        hoverTimeout = null;
      }
      showDropdown();
    }, true);
    
    dropdown.addEventListener('mouseleave', hideDropdown, true);
    
    dropdownSetup = true;
    return true;
  }
  
  // 여러 시점에서 시도
  function trySetup() {
    if (setupPeopleDropdown()) {
      return;
    }
    
    // MutationObserver로 DOM 변경 감지
    const observer = new MutationObserver(function(mutations) {
      if (setupPeopleDropdown()) {
        observer.disconnect();
      }
    });
    
    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
    
    // 일정 시간 후 observer 해제
    setTimeout(function() {
      observer.disconnect();
    }, 5000);
  }
  
  // 즉시 시도
  trySetup();
  
  // DOMContentLoaded에서 실행
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', trySetup);
  }
  
  // window.onload에서도 시도
  window.addEventListener('load', function() {
    setTimeout(trySetup, 100);
  });
})();
</script>
