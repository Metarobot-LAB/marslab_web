<style>
  /* 드롭다운 메뉴 스타일 */
  .custom-dropdown-menu {
    position: absolute !important;
    top: 100% !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    background: #fff !important;
    min-width: 160px !important;
    box-shadow: 0 4px 15px rgba(0,0,0,0.15) !important;
    border: 1px solid #eee !important;
    border-radius: 8px !important;
    z-index: 9999 !important; /* z-index 높임 */
    padding: 8px 0 !important;
    list-style: none !important;
    
    /* [핵심 수정 1] 마진 대신 투명한 테두리를 사용하여 물리적 공간 연결 */
    margin-top: 0 !important; 
    border-top: 10px solid transparent !important; /* 투명 다리로 간격 유지 */
    background-clip: padding-box !important; /* 배경이 투명 테두리를 침범하지 않도록 설정 */
    
    opacity: 0 !important;
    visibility: hidden !important;
    pointer-events: none !important;
    transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out, transform 0.2s ease-in-out !important;
  }

  .custom-dropdown-menu.show {
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto !important;
    transform: translateX(-50%) translateY(0) !important;
  }

  .custom-dropdown-menu::before {
    content: '' !important;
    position: absolute !important;
    /* [핵심 수정 2] 화살표 위치 조정 (투명 테두리 위로 올림) */
    top: -16px !important; /* border-top(10px) + 화살표 높이(6px) 고려 */
    left: 50% !important;
    transform: translateX(-50%) !important;
    border-left: 6px solid transparent !important;
    border-right: 6px solid transparent !important;
    border-bottom: 6px solid #fff !important;
    z-index: 10000 !important;
  }

  .custom-dropdown-menu li {
    margin: 0 !important;
    padding: 0 !important;
    display: block !important;
    text-align: center !important;
  }

  .custom-dropdown-menu a {
    display: block !important;
    padding: 10px 20px !important;
    color: #333 !important;
    text-decoration: none !important;
    font-size: 0.95em !important;
    font-weight: 500 !important;
    transition: background 0.2s !important;
  }

  .custom-dropdown-menu a:hover {
    background-color: #f5f7fa !important;
    color: #000 !important;
  }

  .has-dropdown {
    position: relative !important;
  }

  /* [필수] 상단바가 드롭다운을 가리지 않도록 모든 부모 요소의 overflow 해제 */
  .masthead, 
  .masthead__inner-wrap, 
  .greedy-nav, 
  .greedy-nav .visible-links,
  .greedy-nav__list,
  .greedy-nav__list > li {
    overflow: visible !important;
  }
</style>

<script>
(function() {
  function setupPeopleDropdown() {
    // 1. 이미 설정되었는지 확인
    if (document.querySelector('.custom-dropdown-menu')) {
      return true;
    }
    
    // 2. 'People' 텍스트를 가진 링크 찾기
    const links = document.querySelectorAll('a');
    let peopleLink = null;
    
    for (let link of links) {
      if (link.textContent.trim().toLowerCase() === 'people') {
        // 네비게이션 영역 안에 있는 링크인지 확인 (사이드바 등 제외)
        if (link.closest('.greedy-nav') || link.closest('.masthead')) {
          peopleLink = link;
          break;
        }
      }
    }
    
    if (!peopleLink) return false;
    
    // 3. 부모 li 찾기
    const peopleItem = peopleLink.closest('li');
    if (!peopleItem) return false;
    
    // 4. 클래스 및 스타일 설정
    peopleItem.classList.add('has-dropdown');
    
    // 링크 기능 비활성화
    peopleLink.href = 'javascript:void(0);';
    peopleLink.style.cursor = 'default'; // 커서 변경
    
    // 5. 드롭다운 메뉴 생성
    const dropdown = document.createElement('ul');
    dropdown.className = 'custom-dropdown-menu';
    
    // baseurl 동적 감지
    const currentPath = window.location.pathname;
    let baseurl = '';
    // GitHub Pages 경로 구조 대응 (/저장소이름)
    if (currentPath.indexOf('/', 1) !== -1) {
       // 예: /mars.github.io/index.html -> /mars.github.io 추출
       // 하지만 로컬 테스트나 루트 도메인일 경우를 대비해 간단히 처리
       if (currentPath.includes('/mars.github.io')) {
          baseurl = '/mars.github.io';
       }
    }
    
    dropdown.innerHTML = `
      <li><a href="${baseurl}/students/">Students</a></li>
      <li><a href="${baseurl}/alumni/">Alumni</a></li>
    `;
    
    peopleItem.appendChild(dropdown);
    
    // 6. 이벤트 핸들링 (타이머 로직 개선)
    let hoverTimeout;
    
    function showMenu() {
      clearTimeout(hoverTimeout);
      dropdown.classList.add('show');
    }
    
    function hideMenu() {
      hoverTimeout = setTimeout(() => {
        dropdown.classList.remove('show');
      }, 200); // 0.2초 여유
    }
    
    // 이벤트 바인딩 (li 전체에 걸어서 안정성 확보)
    peopleItem.addEventListener('mouseenter', showMenu);
    peopleItem.addEventListener('mouseleave', hideMenu);
    
    return true;
  }
  
  // 로드 시점 및 DOM 변경 시점 모두 체크 (Greedy Nav 스크립트와의 충돌 방지)
  const observer = new MutationObserver(() => {
    if (setupPeopleDropdown()) {
      // 성공하면 감시 중단 (성능 최적화)
      // observer.disconnect(); // 상황에 따라 주석 해제 (메뉴가 동적으로 다시 그려진다면 계속 감시 필요)
    }
  });

  observer.observe(document.body, { childList: true, subtree: true });
  
  // 초기 실행
  document.addEventListener('DOMContentLoaded', setupPeopleDropdown);
  window.addEventListener('load', setupPeopleDropdown);
})();
</script>
